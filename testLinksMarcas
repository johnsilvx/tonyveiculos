package escolhaPorMarca;

import org.junit.After;
import org.junit.Before;
import org.junit.Test;

import java.util.Set;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;

import org.openqa.selenium.chrome.ChromeDriver;

public class Validacao {

	WebDriver driver;

	@Before
	public void setUp() throws Exception {
		System.setProperty("webdriver.chrome.driver", "./Driver/chromedriver.exe");
		driver = new ChromeDriver();
		driver.manage().window().maximize(); // ACESSA E MAXIMIZA O NAVEGADOR
		driver.get("https://tonyveiculos.com.br/"); // ACESSA O SITE

		RolarPage rolarPage = new RolarPage(driver);
		rolarPage.scroll(); // ROLA A PAGINA ATE A FUNCIONALIDADE QUE QUERO CLICAR
	}

	@After
	public void tearDown() throws Exception {

	}

	@Test
	public void testBMW() throws InterruptedException {
		Thread.sleep(2000); // ESPERA 2 SEGUNDOS PARA A IMAGEM FICA CLICAVEL
		driver.findElement(By.xpath("//*[@id=\"carouselMarcas\"]/div/div[1]/div/div[1]/a/img")).click(); // CLICAR NA IMAGEM DA BMW

		// Obter as alças (handles) das janelas/abas
		Set<String> handles = driver.getWindowHandles();
		String primeiraAba = driver.getWindowHandle();
		handles.remove(primeiraAba);

		// MUDA PARA A NOVA ABA
		String segundaAba = handles.iterator().next();
		driver.switchTo().window(segundaAba);

		// VALIDAR SE O LINK DA IMG É O LINK ESPERADO
		String urlAtual = driver.getCurrentUrl();
		if (urlAtual.equals("https://tonyveiculos.com.br/Estoque/?marca=19")) {
			System.out.println("O link está funcionando corretamente!");
		} else {
			System.out.println("O link não está funcionando corretamente.");
		}
	}
}
